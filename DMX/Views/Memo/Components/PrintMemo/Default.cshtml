@using Microsoft.AspNetCore.Identity

@model DMX.ViewModels.MemoCommentVM;
@inject UserManager<AppUser> usm;

<link href="~/lib/bootstrap/css/bootstrap.css" rel="stylesheet" />
<link href="~/ospapps/timeline.css" rel="stylesheet" />


    
        <div class="row">
            <div class="col-md-3"><image class="logo" style="height:70px;width:70px"></image></div><div class="col-md-6"><h4 class="text-center align-items-center">BOLGATANGA REGIONAL HOSPITAL</h4></div><div class="col-md-3"></div>
      </div>
    <div class="row">
        <div class="col-md-3"></div><div class="col-md-6"><h4 class="text-center">Memorandum</h4></div><div class="col-md-3"></div>
    </div>
    
    <div class="row">
    <div class=" col-xs-4 col-sm-4 col-md-4 col-lg-4"><div class="card border-dark-subtle"><strong>Sender</strong><span>@Model.Sender</span></div></div><div class="col-xs-4 col-sm-4 col-md-4 col-lg-4"></div><div class="col-xs-4 col-sm-4 col-md-4 col-lg-4"><div class="card border-dark-subtle"><strong>Date</strong><span>@Model.CreatedDate.ToString("dd-MMM-yyyy:hh:MM:tt")</span></div></div>
    </div>
  <hr />
        <div class="container mb-1">
            <div class="row">
                
                    <div class="card">
                        <div class="card-body">@Html.Raw(@Model.MemoContent)</div>
                        </div>
                        </div>
                        </div>
                    
                        <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-title">Comments</h6>
                        <div id="content">
                             @foreach (var comment in Model.Comments.OrderByDescending(c=>c.CreatedDate))
                                { 
                            <ul class="timeline">
                                @{
                                    var userPicture=(await usm.FindByIdAsync(comment.CreatedBy)).Picture;
                                    var pictureBase64 = userPicture != null ? Convert.ToBase64String(userPicture) : null;
                                }

                                <!-- User Picture -->
                                @if (pictureBase64 != null)
                                {
                                    <img src="data:image/png;base64,@pictureBase64" alt="User picture" class="rounded-circle me-3" style="width: 40px; height: 40px; object-fit: cover;">
                                }
                                else
                                {
                                    <img src="/path/to/default-image.png" alt="Default" class="rounded-circle me-3" style="width: 40px; height: 40px; object-fit: cover;">


                                }





                                <li class="event" data-date="@comment.CreatedDate.Value.ToString("dd-MMM-yyyy:hh:MM:tt" )">
                                        <h3>@comment.AppUser?.Fullname</h3>
                                    <p>@Html.Raw(@comment.Message)</p>
                                </li>
                                
                            </ul>}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
  

           
       
   
  <script type="text/javascript">
   
          window.print();
   
     
</script>

